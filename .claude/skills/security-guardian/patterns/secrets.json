{
  "version": "1.0.0",
  "last_updated": "2026-01-17",
  "description": "Credential and secret detection patterns",

  "generic_secrets": {
    "name": "Generic API Keys and Secrets",
    "patterns": [
      {
        "id": "SEC-001",
        "name": "Generic API key",
        "pattern": "(?i)(api[_-]?key|apikey)\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-]{20,}['\"]",
        "severity": "CRITICAL",
        "description": "Generic API key detected in source",
        "remediation": "Move to environment variable and add to .gitignore"
      },
      {
        "id": "SEC-002",
        "name": "Generic secret",
        "pattern": "(?i)(secret|secret[_-]?key)\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-]{16,}['\"]",
        "severity": "CRITICAL",
        "description": "Generic secret value in source",
        "remediation": "Use environment variables or secrets manager"
      },
      {
        "id": "SEC-003",
        "name": "Generic token",
        "pattern": "(?i)(access[_-]?token|auth[_-]?token|bearer[_-]?token)\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-\\.]{20,}['\"]",
        "severity": "CRITICAL",
        "description": "Access token hardcoded in source",
        "remediation": "Tokens should be obtained at runtime, not hardcoded"
      },
      {
        "id": "SEC-004",
        "name": "Password assignment",
        "pattern": "(?i)(password|passwd|pwd)\\s*[:=]\\s*['\"][^'\"]{8,}['\"](?!.*\\$\\{|.*process\\.env|.*getenv)",
        "severity": "CRITICAL",
        "description": "Password hardcoded in source",
        "remediation": "Never hardcode passwords, use secure credential storage"
      },
      {
        "id": "SEC-005",
        "name": "Connection string with credentials",
        "pattern": "(?i)(mongodb|postgres|mysql|redis|amqp)://[^:]+:[^@]+@",
        "severity": "CRITICAL",
        "description": "Database connection string with embedded credentials",
        "remediation": "Use environment variables for connection strings"
      }
    ]
  },

  "cloud_providers": {
    "name": "Cloud Provider Credentials",
    "patterns": [
      {
        "id": "AWS-001",
        "name": "AWS Access Key ID",
        "pattern": "(?i)AKIA[0-9A-Z]{16}",
        "severity": "CRITICAL",
        "provider": "AWS",
        "description": "AWS Access Key ID detected",
        "remediation": "Rotate key immediately at AWS IAM console, use IAM roles"
      },
      {
        "id": "AWS-002",
        "name": "AWS Secret Access Key",
        "pattern": "(?i)(aws[_-]?secret[_-]?access[_-]?key|aws[_-]?secret)\\s*[:=]\\s*['\"][A-Za-z0-9/+=]{40}['\"]",
        "severity": "CRITICAL",
        "provider": "AWS",
        "description": "AWS Secret Access Key detected",
        "remediation": "Rotate key immediately, use IAM roles or AWS Secrets Manager"
      },
      {
        "id": "AWS-003",
        "name": "AWS Session Token",
        "pattern": "(?i)(aws[_-]?session[_-]?token)\\s*[:=]\\s*['\"][A-Za-z0-9/+=]{100,}['\"]",
        "severity": "HIGH",
        "provider": "AWS",
        "description": "AWS Session Token detected",
        "remediation": "Session tokens should not be in code, use IAM roles"
      },
      {
        "id": "GCP-001",
        "name": "Google Cloud API Key",
        "pattern": "AIza[0-9A-Za-z\\-_]{35}",
        "severity": "CRITICAL",
        "provider": "GCP",
        "description": "Google Cloud API key detected",
        "remediation": "Rotate key in Google Cloud Console, restrict key usage"
      },
      {
        "id": "GCP-002",
        "name": "Google OAuth Client Secret",
        "pattern": "(?i)(google[_-]?client[_-]?secret|client[_-]?secret)\\s*[:=]\\s*['\"]GOCSPX-[A-Za-z0-9_\\-]{28}['\"]",
        "severity": "CRITICAL",
        "provider": "GCP",
        "description": "Google OAuth client secret detected",
        "remediation": "Rotate in Google Cloud Console, use environment variables"
      },
      {
        "id": "AZURE-001",
        "name": "Azure Storage Account Key",
        "pattern": "(?i)(azure[_-]?storage[_-]?key|storage[_-]?account[_-]?key)\\s*[:=]\\s*['\"][A-Za-z0-9+/=]{88}['\"]",
        "severity": "CRITICAL",
        "provider": "Azure",
        "description": "Azure Storage account key detected",
        "remediation": "Rotate key in Azure Portal, use managed identities"
      },
      {
        "id": "AZURE-002",
        "name": "Azure Connection String",
        "pattern": "(?i)DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/=]+",
        "severity": "CRITICAL",
        "provider": "Azure",
        "description": "Azure Storage connection string with key",
        "remediation": "Use environment variables, consider managed identities"
      }
    ]
  },

  "code_platforms": {
    "name": "Code Platform Tokens",
    "patterns": [
      {
        "id": "GH-001",
        "name": "GitHub Personal Access Token",
        "pattern": "ghp_[A-Za-z0-9]{36}",
        "severity": "CRITICAL",
        "provider": "GitHub",
        "description": "GitHub Personal Access Token detected",
        "remediation": "Revoke at github.com/settings/tokens, use GitHub Apps"
      },
      {
        "id": "GH-002",
        "name": "GitHub OAuth Access Token",
        "pattern": "gho_[A-Za-z0-9]{36}",
        "severity": "CRITICAL",
        "provider": "GitHub",
        "description": "GitHub OAuth Access Token detected",
        "remediation": "Tokens should be obtained dynamically, not stored"
      },
      {
        "id": "GH-003",
        "name": "GitHub App Token",
        "pattern": "(ghu|ghs)_[A-Za-z0-9]{36}",
        "severity": "CRITICAL",
        "provider": "GitHub",
        "description": "GitHub App Token detected",
        "remediation": "Use environment variables for app credentials"
      },
      {
        "id": "GH-004",
        "name": "GitHub Refresh Token",
        "pattern": "ghr_[A-Za-z0-9]{36}",
        "severity": "CRITICAL",
        "provider": "GitHub",
        "description": "GitHub Refresh Token detected",
        "remediation": "Refresh tokens must be stored securely, not in code"
      },
      {
        "id": "GL-001",
        "name": "GitLab Personal Access Token",
        "pattern": "glpat-[A-Za-z0-9\\-_]{20,}",
        "severity": "CRITICAL",
        "provider": "GitLab",
        "description": "GitLab Personal Access Token detected",
        "remediation": "Revoke in GitLab settings, use CI/CD variables"
      },
      {
        "id": "BB-001",
        "name": "Bitbucket App Password",
        "pattern": "(?i)(bitbucket[_-]?app[_-]?password|bb[_-]?app[_-]?password)\\s*[:=]\\s*['\"][A-Za-z0-9]{20,}['\"]",
        "severity": "CRITICAL",
        "provider": "Bitbucket",
        "description": "Bitbucket app password detected",
        "remediation": "Use repository variables for CI/CD"
      }
    ]
  },

  "payment_providers": {
    "name": "Payment Provider Keys",
    "patterns": [
      {
        "id": "STRIPE-001",
        "name": "Stripe Live Secret Key",
        "pattern": "sk_live_[0-9a-zA-Z]{24,}",
        "severity": "CRITICAL",
        "provider": "Stripe",
        "description": "Stripe LIVE secret key - can process real payments!",
        "remediation": "URGENT: Rotate immediately at dashboard.stripe.com/apikeys"
      },
      {
        "id": "STRIPE-002",
        "name": "Stripe Test Secret Key",
        "pattern": "sk_test_[0-9a-zA-Z]{24,}",
        "severity": "HIGH",
        "provider": "Stripe",
        "description": "Stripe test secret key in source",
        "remediation": "Use environment variables even for test keys"
      },
      {
        "id": "STRIPE-003",
        "name": "Stripe Restricted Key",
        "pattern": "rk_live_[0-9a-zA-Z]{24,}",
        "severity": "CRITICAL",
        "provider": "Stripe",
        "description": "Stripe restricted live key detected",
        "remediation": "Rotate at dashboard.stripe.com/apikeys"
      },
      {
        "id": "PP-001",
        "name": "PayPal Client Secret",
        "pattern": "(?i)(paypal[_-]?client[_-]?secret|paypal[_-]?secret)\\s*[:=]\\s*['\"][A-Za-z0-9_\\-]{40,}['\"]",
        "severity": "CRITICAL",
        "provider": "PayPal",
        "description": "PayPal client secret detected",
        "remediation": "Rotate in PayPal Developer Dashboard"
      },
      {
        "id": "SQ-001",
        "name": "Square Access Token",
        "pattern": "sq0atp-[0-9A-Za-z\\-_]{22}|EAAAE[A-Za-z0-9]{60}",
        "severity": "CRITICAL",
        "provider": "Square",
        "description": "Square access token detected",
        "remediation": "Rotate in Square Developer Dashboard"
      }
    ]
  },

  "communication_services": {
    "name": "Communication Service Keys",
    "patterns": [
      {
        "id": "SLACK-001",
        "name": "Slack Bot Token",
        "pattern": "xoxb-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24}",
        "severity": "CRITICAL",
        "provider": "Slack",
        "description": "Slack bot token - can send messages as bot",
        "remediation": "Rotate at api.slack.com/apps"
      },
      {
        "id": "SLACK-002",
        "name": "Slack User Token",
        "pattern": "xoxp-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24,}",
        "severity": "CRITICAL",
        "provider": "Slack",
        "description": "Slack user token - can act as user",
        "remediation": "Rotate immediately, user tokens are high-privilege"
      },
      {
        "id": "SLACK-003",
        "name": "Slack Webhook URL",
        "pattern": "https://hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+",
        "severity": "HIGH",
        "provider": "Slack",
        "description": "Slack webhook URL - can post to channel",
        "remediation": "Regenerate webhook in Slack app settings"
      },
      {
        "id": "TWILIO-001",
        "name": "Twilio API Key",
        "pattern": "SK[0-9a-fA-F]{32}",
        "severity": "CRITICAL",
        "provider": "Twilio",
        "description": "Twilio API key detected",
        "remediation": "Rotate in Twilio Console"
      },
      {
        "id": "TWILIO-002",
        "name": "Twilio Auth Token",
        "pattern": "(?i)(twilio[_-]?auth[_-]?token)\\s*[:=]\\s*['\"][a-f0-9]{32}['\"]",
        "severity": "CRITICAL",
        "provider": "Twilio",
        "description": "Twilio auth token detected",
        "remediation": "Rotate in Twilio Console under Account Settings"
      },
      {
        "id": "SG-001",
        "name": "SendGrid API Key",
        "pattern": "SG\\.[a-zA-Z0-9_\\-]{22}\\.[a-zA-Z0-9_\\-]{43}",
        "severity": "CRITICAL",
        "provider": "SendGrid",
        "description": "SendGrid API key - can send emails",
        "remediation": "Rotate in SendGrid Settings > API Keys"
      },
      {
        "id": "MG-001",
        "name": "Mailgun API Key",
        "pattern": "key-[a-zA-Z0-9]{32}",
        "severity": "CRITICAL",
        "provider": "Mailgun",
        "description": "Mailgun API key detected",
        "remediation": "Rotate in Mailgun Dashboard"
      }
    ]
  },

  "baas_services": {
    "name": "Backend-as-a-Service Credentials",
    "patterns": [
      {
        "id": "SUPA-001",
        "name": "Supabase Service Role Key",
        "pattern": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\\.[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+",
        "severity": "CRITICAL",
        "provider": "Supabase",
        "requires_context": "service_role",
        "description": "Supabase service_role key bypasses RLS",
        "remediation": "CRITICAL: This key bypasses all Row Level Security. Use anon key for client-side."
      },
      {
        "id": "SUPA-002",
        "name": "Supabase service_role in code",
        "pattern": "(?i)(service[_-]?role|SERVICE[_-]?ROLE).*[:=].*['\"][^'\"]+['\"]",
        "severity": "CRITICAL",
        "provider": "Supabase",
        "description": "Supabase service_role reference in source",
        "remediation": "Service role keys should only be used server-side with env vars"
      },
      {
        "id": "SUPA-003",
        "name": "Supabase key in client code",
        "pattern": "(?i)(NEXT_PUBLIC|VITE|REACT_APP).*SUPABASE.*(SERVICE|ROLE)",
        "severity": "CRITICAL",
        "provider": "Supabase",
        "description": "Service role key exposed via public env var",
        "remediation": "NEVER use service_role in NEXT_PUBLIC/VITE/REACT_APP vars"
      },
      {
        "id": "SUPA-004",
        "name": "Supabase URL + Key pair",
        "pattern": "(?i)supabaseUrl.*supabaseKey|createClient\\s*\\([^)]+,[^)]+\\)",
        "severity": "MEDIUM",
        "provider": "Supabase",
        "description": "Supabase client initialization - verify key type",
        "remediation": "Ensure using anon key (not service_role) for client-side code"
      },
      {
        "id": "FB-001",
        "name": "Firebase Admin SDK private key",
        "pattern": "-----BEGIN (RSA )?PRIVATE KEY-----",
        "severity": "CRITICAL",
        "provider": "Firebase",
        "description": "Private key in source - possibly Firebase Admin SDK",
        "remediation": "Private keys must be in secure storage, never in code"
      },
      {
        "id": "FB-002",
        "name": "Firebase service account",
        "pattern": "(?i)(firebase[_-]?admin|service[_-]?account).*private[_-]?key",
        "severity": "CRITICAL",
        "provider": "Firebase",
        "description": "Firebase service account credentials in code",
        "remediation": "Use GOOGLE_APPLICATION_CREDENTIALS env var"
      },
      {
        "id": "FB-003",
        "name": "Firebase Database URL with secret",
        "pattern": "https://[a-z0-9-]+\\.firebaseio\\.com.*auth=",
        "severity": "CRITICAL",
        "provider": "Firebase",
        "description": "Firebase Realtime Database URL with auth secret",
        "remediation": "Remove auth parameter, use Firebase Auth instead"
      }
    ]
  },

  "jwt_tokens": {
    "name": "JWT and Session Tokens",
    "patterns": [
      {
        "id": "JWT-001",
        "name": "JWT Token",
        "pattern": "eyJ[A-Za-z0-9_-]*\\.eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*",
        "severity": "HIGH",
        "description": "JWT token in source code",
        "remediation": "JWTs should be generated dynamically, not stored in code"
      },
      {
        "id": "JWT-002",
        "name": "JWT Secret",
        "pattern": "(?i)(jwt[_-]?secret|token[_-]?secret)\\s*[:=]\\s*['\"][^'\"]{16,}['\"]",
        "severity": "CRITICAL",
        "description": "JWT signing secret hardcoded",
        "remediation": "Use strong random secret from environment variable"
      }
    ]
  },

  "private_keys": {
    "name": "Private Keys and Certificates",
    "patterns": [
      {
        "id": "PK-001",
        "name": "RSA Private Key",
        "pattern": "-----BEGIN RSA PRIVATE KEY-----",
        "severity": "CRITICAL",
        "description": "RSA private key in source",
        "remediation": "Private keys must never be in source control"
      },
      {
        "id": "PK-002",
        "name": "EC Private Key",
        "pattern": "-----BEGIN EC PRIVATE KEY-----",
        "severity": "CRITICAL",
        "description": "Elliptic curve private key in source",
        "remediation": "Use secure key management, not source code"
      },
      {
        "id": "PK-003",
        "name": "OpenSSH Private Key",
        "pattern": "-----BEGIN OPENSSH PRIVATE KEY-----",
        "severity": "CRITICAL",
        "description": "SSH private key in source",
        "remediation": "Remove immediately, regenerate SSH keys"
      },
      {
        "id": "PK-004",
        "name": "PGP Private Key",
        "pattern": "-----BEGIN PGP PRIVATE KEY BLOCK-----",
        "severity": "CRITICAL",
        "description": "PGP private key in source",
        "remediation": "Private keys must be stored securely, not in code"
      }
    ]
  },

  "ai_specific": {
    "name": "AI/ML API Keys",
    "patterns": [
      {
        "id": "OAI-001",
        "name": "OpenAI API Key",
        "pattern": "sk-[A-Za-z0-9]{48}|sk-proj-[A-Za-z0-9]{48}",
        "severity": "CRITICAL",
        "provider": "OpenAI",
        "description": "OpenAI API key - can incur charges",
        "remediation": "Rotate at platform.openai.com/api-keys"
      },
      {
        "id": "ANT-001",
        "name": "Anthropic API Key",
        "pattern": "sk-ant-[A-Za-z0-9\\-]{32,}",
        "severity": "CRITICAL",
        "provider": "Anthropic",
        "description": "Anthropic API key detected",
        "remediation": "Rotate at console.anthropic.com"
      },
      {
        "id": "HF-001",
        "name": "Hugging Face Token",
        "pattern": "hf_[A-Za-z0-9]{34}",
        "severity": "HIGH",
        "provider": "Hugging Face",
        "description": "Hugging Face access token",
        "remediation": "Rotate at huggingface.co/settings/tokens"
      }
    ]
  }
}
